<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <title>VinWonders</title>
    <link rel="icon" type="image/png" href="/assets/iconlogo.png" />
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
      integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <!-- LeafletJS CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
      /* You can move these to style.css */
      body {
        margin: 0;
        font-family: Arial, sans-serif;
        padding-top: env(safe-area-inset-top);
        padding-bottom: env(safe-area-inset-bottom);
      }

      .map-container {
        display: flex;
        flex-direction: column;
        height: 100vh;
      }

      .map-head {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background-color: #f77119;
        color: white;
        padding: 10px 16px;
        padding-top: max(10px, env(safe-area-inset-top));
        font-size: 18px;
      }

      .map-wrapper {
        position: relative;
        flex: 1;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        background: #ffe2c5;
      }

      .map {
        max-height: 100%;
        width: auto;
        cursor: grab; /* show grab cursor when pannable */
        touch-action: none; /* allow pointer events for touch panning */
        will-change: transform;
        user-select: none; /* prevent text selection during drag */
      }

      .map.grabbing {
        cursor: grabbing;
      }

      /* Zoom buttons */
      .zoom-controls {
        position: absolute;
        bottom: max(20px, env(safe-area-inset-bottom));
        right: 20px;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .zoom-btn {
        background-color: #f77119;
        color: white;
        border: none;
        border-radius: 6px;
        padding: 10px 14px;
        font-size: 18px;
        cursor: pointer;
        transition: background-color 0.2s;
      }

      .zoom-btn:hover {
        background-color: #ec6003;
      }
    </style>
  </head>

  <body>
    <div class="map-container">
      <div class="map-head">
        <a href="./index.html">
          <i class="fa-solid fa-arrow-left"></i>
        </a>
        <p>VinWonders Nha Trang</p>
        <div></div>
      </div>

      <div class="map-wrapper">
        <div id="map" style="width: 100%; height: 100%"></div>
        <div class="zoom-controls">
          <button class="zoom-btn" id="zoomIn">
            <i class="fa-solid fa-plus"></i>
          </button>
          <button class="zoom-btn" id="zoomOut">
            <i class="fa-solid fa-minus"></i>
          </button>
        </div>
      </div>
    </div>

    <script>
      // LeafletJS integration
      // Add LeafletJS script
      const leafletScript = document.createElement("script");
      leafletScript.src = "https://unpkg.com/leaflet/dist/leaflet.js";
      document.body.appendChild(leafletScript);

      leafletScript.onload = function () {
        // Attractions data
        const attractions = [
          { name: "Gi·∫£i m√£ m√™ cung", x: 1259, y: 1154, wait_time: 30 },
          { name: "ƒê∆∞·ªùng ƒëua ngh·∫πt th·ªü", x: 1378, y: 1124, wait_time: null },
          { name: "ƒê∆∞·ªùng l∆∞·ª£n nh·ªõ ƒë·ªùi", x: 1494, y: 1040, wait_time: 32 },
          { name: "B·∫≠t nh·∫£y bungee", x: 1750, y: 1054, wait_time: 17 },
          { name: "Th√°p r∆°i t·ª± do", x: 1858, y: 1052, wait_time: 15 },
          { name: "ƒêua xe tr√™n kh√¥ng", x: 1962, y: 1078, wait_time: 27 },
          { name: "Cu·ªôc phi√™u l∆∞u h·∫ßm m·ªè", x: 2116, y: 1226, wait_time: 13 },
          { name: "ƒêu quay d√¢y v√†ng", x: 1912, y: 1260, wait_time: 10 },
          { name: "Tata Show", x: 1460, y: 1298, wait_time: 60 },
          { name: "Cung ƒëi·ªán √°nh s√°ng", x: 1556, y: 1368, wait_time: 12 },
          { name: "V∆∞∆°ng qu·ªëc k·∫πo ng·ªçt", x: 1374, y: 1492, wait_time: 13 },
          { name: "Cu·ªôc chi·∫øn c·∫ßu v·ªìng", x: 1472, y: 1798, wait_time: 30 },
          { name: "R·∫°p phim bay", x: 1720, y: 1674, wait_time: 45 },
          { name: "V∆∞·ªùn th√∫", x: 2092, y: 1774, wait_time: 7 },
          { name: "C√∫ r∆°i th√≥t tim", x: 1404, y: 2048, wait_time: 23 },
          { name: "ƒêƒ©a bay v≈© tr·ª•", x: 1522, y: 2192, wait_time: 10 },
          { name: "V√≤i r·ªìng hung h√£n", x: 1414, y: 2286, wait_time: 15 },
          { name: "Th√°c ƒë√¥i th·∫ßn b√≠", x: 1812, y: 2263, wait_time: 8 },
          { name: "Cu·ªôc ƒëua b√°o Cheetah", x: 1744, y: 2332, wait_time: 17 },
          { name: "T·∫©u tho√°t ngo·∫°n m·ª•c", x: 1730, y: 2422, wait_time: 20 },
          { name: "Ph√°o ƒë√†i k√¨ b√≠", x: 1518, y: 2564, wait_time: 18 },
          { name: "Ng√¥i l√†ng th·ªßy t·ªôc", x: 1704, y: 2614, wait_time: 22 },
          { name: "Ng√¥i ƒë·ªÅn huy·ªÅn tho·∫°i", x: 1594, y: 2780, wait_time: 12 },
          { name: "S·∫Øc m√†u m√πa ƒë√¥ng", x: 2128, y: 2288, wait_time: 7 },
          { name: "Hoang m·∫°c ch√¢u Phi", x: 2264, y: 2440, wait_time: 9 },
          { name: "V∆∞·ªùn Nh·∫≠t", x: 2474, y: 2488, wait_time: 16 },
          { name: "V∆∞·ªùn b∆∞·ªõm", x: 2324, y: 2604, wait_time: 10 },
          { name: "L·∫ßu v·ªçng c·∫£nh", x: 2434, y: 2682, wait_time: 8 },
          { name: "B√°nh xe b·∫ßu tr·ªùi", x: 2052, y: 2710, wait_time: 12 },
          { name: "Sky Garden", x: 2174, y: 2760, wait_time: 15 },
          { name: "S·∫Øc m√†u Bromelias", x: 2324, y: 2748, wait_time: 8 },
          { name: "Zipline", x: 2720, y: 874, wait_time: 28 },
        ];

        function getCrowdStatus(waitTime) {
          if (waitTime === null) {
            return { status: "B·∫£o tr√¨", color: "#999", icon: "üîß" };
          } else if (waitTime < 10) {
            return { status: "Th√¥ng tho√°ng", color: "#4CAF50", icon: "‚úì" };
          } else if (waitTime < 20) {
            return { status: "B√¨nh th∆∞·ªùng", color: "#FFC107", icon: "‚óã" };
          } else if (waitTime < 40) {
            return { status: "ƒê√¥ng", color: "#FF9800", icon: "‚óê" };
          } else {
            return { status: "R·∫•t ƒë√¥ng", color: "#F44336", icon: "‚óè" };
          }
        }

        // Use custom image as map base
        // Set image dimensions (replace with your actual image size)
        const imageWidth = 3000; // <-- set your map image width in pixels
        const imageHeight = 3000; // <-- set your map image height in pixels

        // Define image bounds: top-left [0,0], bottom-right [imageHeight, imageWidth]
        const bounds = [
          [0, 0],
          [imageHeight, imageWidth],
        ];

        // Initialize Leaflet map with simple CRS and restrict view to image bounds
        const map = L.map("map", {
          crs: L.CRS.Simple,
          minZoom: -2,
          maxZoom: 4,
          zoomControl: false,
          maxBounds: bounds,
          maxBoundsViscosity: 1.0,
        });

        // Add image overlay
        L.imageOverlay("./assets/map.jpg", bounds).addTo(map);
        map.fitBounds(bounds);

        // Custom zoom controls
        document.getElementById("zoomIn").onclick = () => map.zoomIn();
        document.getElementById("zoomOut").onclick = () => map.zoomOut();

        // Ready for adding markers/points later
        // To add a marker: L.marker([y, x]).addTo(map)
        attractions.forEach((attraction) => {
          const crowdInfo = getCrowdStatus(attraction.wait_time);

          // Create custom icon with color based on crowd status
          const customIcon = L.divIcon({
            className: "custom-marker",
            html: `<div style="background-color: ${crowdInfo.color}; width: 20px; height: 20px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"></div>`,
            iconSize: [20, 20],
            iconAnchor: [10, 10],
          });

          const marker = L.marker([attraction.y, attraction.x], {
            icon: customIcon,
          }).addTo(map);

          const waitTimeText =
            attraction.wait_time === null
              ? '<span style="color: #999; font-weight: bold;">ƒêang b·∫£o tr√¨ üîß</span>'
              : `<span style="color: ${crowdInfo.color}; font-weight: bold;">${attraction.wait_time} ph√∫t</span>`;

          const popupContent = `
                  <div style="min-width: 150px; padding: 5px;">
                    <h4 style="margin: 0 0 8px 0; color: #333; font-size: 14px;">${attraction.name}</h4>
                    <p style="margin: 4px 0; font-size: 13px;">
                      <strong>Th·ªùi gian ch·ªù:</strong> ${waitTimeText}
                    </p>
                    <p style="margin: 4px 0; font-size: 13px;">
                      <strong>T√¨nh tr·∫°ng:</strong>
                      <span style="color: ${crowdInfo.color}; font-weight: bold;">${crowdInfo.icon} ${crowdInfo.status}</span>
                    </p>
                  </div>
                `;

          marker.bindPopup(popupContent);
        });
      };
    </script>
    <!-- LeafletJS JS -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  </body>
</html>
