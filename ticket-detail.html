<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VinWonders</title>
      <link rel="icon" type="image/png" href="/assets/iconlogo.png" />
    <link rel="stylesheet" href="./style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
      integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
  </head>
  <body>
    <div class="wrapperDetaiTicket">
      <div class="ticket-detail">
        <div class="banner">
          <img
            src="./assets/vinwonders-nha-trang.jpg"
            alt="VinWonders Nha Trang"
          />
          <div class="back-btn">
            <a href="./ticket.html"><i class="fa-solid fa-arrow-left"></i></a>
          </div>
          <div class="cart-btn"><i class="fa-regular fa-heart"></i></div>
        </div>
        <div class="info">
          <h2>VinWonders Nha Trang</h2>
          <p class="rating"><span>‚≠ê 4.2</span> (7529 l∆∞·ª£t ƒë√°nh gi√°)</p>

          <div class="date-buttons">
            <button>H√¥m nay</button>
            <button>Ng√†y mai</button>
            <button class="active">
              <i class="fa-regular fa-calendar"></i> 27/10/2025
            </button>
          </div>

          <div class="filter-buttons">
            <button class="active">T·∫•t c·∫£ v√©</button>
            <button><i class="fa-solid fa-fire"></i> B√°n ch·∫°y nh·∫•t</button>
            <button>G√≥i VIP</button>
          </div>
        </div>

        <div class="ticket-card-list" id="ticketCardList">
          <div class="ticket-card">
            <h3>
              [VinWonders Nha Trang] - Combo V√© V√†o C·ª≠a VinWonders + D·ªãch v·ª•
              Buffet
            </h3>
            <ul>
              <li>V√© v√†o c·ª≠a khu vui ch∆°i 01 l·∫ßn trong ng√†y</li>
              <li>Th∆∞·ªüng th·ª©c buffet tr∆∞a t·∫°i nh√† h√†ng Wind & Sea</li>
              <li>02 l∆∞·ª£t VinBus mi·ªÖn ph√≠ trong ng√†y</li>
            </ul>
            <a href="#">Xem chi ti·∫øt ¬ª</a>

            <div class="price-box">
              <p>Ch·ªâ t·ª´ <span class="price">1.100.000 ƒë</span></p>
              <button class="btn-choose">Ch·ªçn</button>
            </div>
          </div>
          <div class="ticket-card">
            <h3>
              [VinWonders Nha Trang] - V√© V√†o C·ª≠a Ti√™u Chu·∫©n | T·∫∑ng Voucher ·∫©m
              th·ª±c
            </h3>
            <ul>
              <li>V√© v√†o c·ª≠a khu vui ch∆°i 01 l·∫ßn trong ng√†y</li>
              <li>
                Di chuy·ªÉn b·∫±ng c√°p treo 02 chi·ªÅu + 02 l∆∞·ª£t VinBus mi·ªÖn ph√≠
              </li>
              <li>T·∫∑ng Voucher ·∫©m th·ª±c t·ª´ 15/08 - 30/11</li>
            </ul>
            <a href="#">Xem chi ti·∫øt ¬ª</a>

            <div class="price-box">
              <p>Ch·ªâ t·ª´ <span class="price">950.000 ƒë</span></p>
              <button class="btn-choose">Ch·ªçn</button>
            </div>
          </div>
          <div class="ticket-card">
            <h3>[VinWonders Nha Trang] - V√© v√†o c·ª≠a VinWonders sau 16h00</h3>
            <ul>
              <li>V√© v√†o c·ª≠a khu vui ch∆°i 01 l·∫ßn trong ng√†y</li>
              <li>Di chuy·ªÉn b·∫±ng c√°p treo 02 chi·ªÅu</li>
              <li>02 l∆∞·ª£t VinBus mi·ªÖn ph√≠ trong ng√†y</li>
            </ul>
            <a href="#">Xem chi ti·∫øt ¬ª</a>

            <div class="price-box">
              <p>Ch·ªâ t·ª´ <span class="price">660.000 ƒë</span></p>
              <button class="btn-choose">Ch·ªçn</button>
            </div>
          </div>
        </div>
      </div>

      <!-- modal chi ti·∫øt v√© -->
      <div id="ticketModal" class="modal">
        <div class="modal-content">
          <span class="close-btn">&times;</span>
          <h3 class="modal-title">Chi ti·∫øt v√©</h3>
          <p class="modal-description">
            ƒê√¢y l√† m√¥ t·∫£ chi ti·∫øt c·ªßa g√≥i v√© b·∫°n ch·ªçn.
          </p>
        </div>
      </div>
      <!-- modal mua v√© -->
      <div id="buyModal" class="modalBuyTicket">
        <div class="modal-content ticket-buy">
          <span class="close-btn">&times;</span>
          <h3 class="modal-title">Ch·ªçn lo·∫°i v√©</h3>
          <p>[Vinpearl Harbour] - V√© xem Tata Show</p>

          <!-- Ch·ªçn c∆° s·ªü -->
          <div class="location-section">
            <h4><i class="fa-solid fa-location-dot"></i> Ch·ªçn c∆° s·ªü</h4>
            <div class="location-options">
              <button class="active">ZooKeeper NT</button>
            </div>
          </div>

          <!-- Ch·ªçn th·ªùi gian -->
          <div class="time-section">
            <h4><i class="fa-regular fa-clock"></i> Ch·ªçn th·ªùi gian</h4>
            <div class="time-options">
              <button class="time-btn active">9:30</button>
              <button class="time-btn">14:00</button>
            </div>
          </div>

          <div class="quantity-section">
            <h4><i class="fa-solid fa-user-group"></i> S·ªë l∆∞·ª£ng mua</h4>

            <div class="ticket-type">
              <div>
                <p>Ng∆∞·ªùi l·ªõn</p>
                <small>Cao t·ª´ 140cm</small>
              </div>
              <div class="price">100,000 ƒë</div>
              <div class="counter">
                <button class="minus">‚àí</button>
                <span class="count">1</span>
                <button class="plus">+</button>
              </div>
            </div>

            <div class="ticket-type">
              <div>
                <p>Tr·∫ª em</p>
                <small
                  >Cao t·ª´ <br />
                  100cm‚Äì139cm</small
                >
              </div>
              <div class="price">100,000 ƒë</div>
              <div class="counter">
                <button class="minus">‚àí</button>
                <span class="count">0</span>
                <button class="plus">+</button>
              </div>
            </div>

            <div class="ticket-type">
              <div>
                <p>Ng∆∞·ªùi cao tu·ªïi</p>
                <small>T·ª´ 60 tu·ªïi</small>
              </div>
              <div class="price">100,000 ƒë</div>
              <div class="counter">
                <button class="minus">‚àí</button>
                <span class="count">0</span>
                <button class="plus">+</button>
              </div>
            </div>
          </div>

          <div class="footer">
            <span class="total">100,000 ƒë</span>
            <button class="buy-btn">Mua ngay</button>
          </div>
        </div>
      </div>
    </div>
    <script>
      const params = new URLSearchParams(window.location.search);
      const selectedLocation = params.get("location");
      const selectedDate = params.get("date");

      // --- C·∫≠p nh·∫≠t v√†o giao di·ªán ---
      // G·∫Øn t√™n ƒëi·ªÉm ƒë·∫øn v√†o th·∫ª h2
      const titleElement = document.querySelector(".info h2");
      if (selectedLocation) {
        titleElement.textContent = selectedLocation;
      } else {
        titleElement.textContent = "Kh√¥ng c√≥ d·ªØ li·ªáu";
      }

      // G·∫Øn ng√†y v√†o n√∫t l·ªãch
      const dateButton = document.querySelector(".date-buttons button.active");
      if (selectedDate) {
        dateButton.innerHTML = `<i class="fa-regular fa-calendar"></i> ${selectedDate}`;
      } else {
        dateButton.innerHTML = `<i class="fa-regular fa-calendar"></i> Kh√¥ng c√≥ d·ªØ li·ªáu`;
      }

      const modal = document.getElementById("ticketModal");
      const modalTitle = document.querySelector(".modal-title");
      const modalDescription = document.querySelector(".modal-description");
      const closeBtn = document.querySelector(".close-btn");

      // Store images for each ticket
      const ticketImages = {
        "sau 16h00": [
          "https://booking-static.vinpearl.com/tours/54f14485263b441cb85ea95944b3e72e_Hinh-anh-VinWonders-Nha-Trang-The-World-Garden-Lau-vong-canh-3x2-so-1_vinwonders-nha-trang-ve-vao-cua-sau-16h.jpg",
          "https://booking-static.vinpearl.com/tours/6031fab8e33e406b9f15135a1ef23c7c_Hinh-anh-VinWonders-Nha-Trang-Adventure-Land-Du-quay-day-vang-3x2-so-3_vinwonders-nha-trang-ve-vao-cua-sau-16h.jpg",
          "https://booking-static.vinpearl.com/tours/3feaf03ff50045a4981546b11a209c4a_vwnt%206_vinwonders-nha-trang-ve-vao-cua-sau-16h.jpg",
          "https://booking-static.vinpearl.com/tours/0693361e457746caa7ccf1f541be6c73__KAH2448_vinwonders-nha-trang-ve-vao-cua-sau-16h.jpg",
        ],
        "Ti√™u Chu·∫©n": [
          "https://booking-static.vinpearl.com/tours/da291b91c381457e9c5a02999b54a314_6267d5a4a9564a438ce1ee3a66159651_vwnt%202_vinwonders-nha-trang-khong-gioi-han-1-ngay_vinwonders-nha-trang-ve-vao-cua-2-chieu.jpg",
          "https://booking-static.vinpearl.com/tours/fd8d6df9fb4e457387f15b368f91d144_83a78d624f7340aaab5c6fa10d297e67_vwnt%205_vinwonders-nam-hoi-an-ve-vao-cua_vinwonders-nha-trang-ve-vao-cua-2-chieu.jpg",
          "https://booking-static.vinpearl.com/tours/ff580ab05241434185a09c928c1b05e1_%E1%BA%A3nh_vinwonders-nha-trang-ve-vao-cua-2-chieu.jpg",
          "https://booking-static.vinpearl.com/tours/3deddd0d25da4fd0a5604930ae46bf45_6d3dba25e48b48fda66aa328953577b7_Hinh-anh-VinWonders-Nha-Trang-King's-Garden-3x2-so-29_vinwonders-nha-trang-khong-gioi-han-1-ngay_vinwonders-nha-trang-ve-vao-cua-2-chieu.jpg",
          "https://booking-static.vinpearl.com/tours/31aab7c16a144b9f9a9da16e2ca7f11a_41ba94f9b3c44de9add5969c8669857c__KAH2448_vinwonders-nha-trang-khong-gioi-han-1-ngay_vinwonders-nha-trang-ve-vao-cua-2-chieu.jpg",
          "https://booking-static.vinpearl.com/tours/2b86912038fb4f818f0af8ba68efd9bd_2b0eda2e986e4735a9a2ae4779ef8a6c_VWNT_Tropical%20Paradise7_vinwonders-nha-trang-khong-gioi-han-1-ngay_vinwonders-nha-trang-ve-vao-cua-2-chieu.jpg",
        ],
        Combo: [
          "https://booking-static.vinpearl.com/tours/99ede30869d345dd8d7674b86f9283e5__KAH2209_vinwonders-nha-trang-ve-vao-cua-2-chieu.jpg",
          "https://booking-static.vinpearl.com/tours/cd9ddcdcaf454d3c9b3365f29509bba2_vwnt 5_vinwonders-nha-trang-ve-vao-cua-2-chieu.jpg",
          "https://booking-static.vinpearl.com/tours/139de0aace854b8f80b3e6a9c27faff1_tro-choi-mao-hiem-o-vinpearl-nha-trang-thumb-1_vinwonders-nha-trang-ve-vao-cua-2-chieu.jpg",
          "https://booking-static.vinpearl.com/tours/b16ae40ca10541bd9538650b4496bfc3_vwnt 2_vinwonders-nha-trang-ve-vao-cua-2-chieu.jpg",
          "https://booking-static.vinpearl.com/tours/b52243e18059465db856e4fa04260237_VWNT_Tropical Paradise19_vinwonders-nha-trang-ve-vao-cua-2-chieu.jpg",
          "https://booking-static.vinpearl.com/tours/a556178630a44692bb5dd0ea416d3532_vwnt 6_vinwonders-nha-trang-ve-vao-cua-2-chieu.jpg",
        ],
      };

      let currentImageIndex = 0;
      let currentImages = [];

      // L·∫Øng nghe click v√†o c√°c n√∫t "Xem chi ti·∫øt"
      // Helper function to create image slider HTML
      function createImageSlider(images, title) {
        if (images.length === 0) return "";

        return `
                     <div class="modal-image-slider">
                       <button class="slider-btn prev-btn">
                         <i class="fa-solid fa-chevron-left"></i>
                       </button>
                       <img id="modalImage" src="${images[0]}" alt="${title}" />
                       <button class="slider-btn next-btn">
                         <i class="fa-solid fa-chevron-right"></i>
                       </button>
                       <div class="image-counter">
                         <span id="currentImageNum">1</span> / ${images.length}
                       </div>
                     </div>
                   `;
      }

      // Helper function to attach slider event listeners
      function attachSliderListeners() {
        setTimeout(() => {
          const prevBtn = modal.querySelector(".prev-btn");
          const nextBtn = modal.querySelector(".next-btn");

          if (prevBtn) {
            prevBtn.onclick = () => changeImage(-1);
          }
          if (nextBtn) {
            nextBtn.onclick = () => changeImage(1);
          }
        }, 100);
      }

      // Function for "V√© v√†o c·ª≠a VinWonders sau 16h00"
      function showTicketAfter16hDetail() {
        const title =
          "[VinWonders Nha Trang] - V√© v√†o c·ª≠a VinWonders sau 16h00";
        currentImages = ticketImages["sau 16h00"];
        currentImageIndex = 0;

        modalTitle.textContent = title;

        let details = createImageSlider(currentImages, title);

        details += `
                     <h4>BAO G·ªíM</h4>
                     <ul>
                       <li>- V√© v√†o c·ª≠a tr·ª±c ti·∫øp VinWonders Nha Trang sau 16:00</li>
                       <li>- Di chuy·ªÉn b·∫±ng c√°p treo 2 chi·ªÅu</li>
                       <li>- Mi·ªÖn ph√≠ 02 l∆∞·ª£t s·ª≠ d·ª•ng d·ªãch v·ª• xe bu√Ωt VinBus trong ng√†y</li>
                     </ul>
                     <h4>ƒêI·ªÄU KHO·∫¢N</h4>
                     <ul>
                       <li>- Trong tr∆∞·ªùng h·ª£p th·ªùi ti·∫øt kh√¥ng thu·∫≠n l·ª£i, c√°p treo bu·ªôc ph·∫£i d·ª´ng ho·∫°t ƒë·ªông ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n, VinWonders s·∫Ω s·∫Øp x·∫øp ph∆∞∆°ng ti·ªán di chuy·ªÉn thay th·∫ø b·∫±ng t√†u cao t·ªëc</li>
                       <li>- Zipline kh√¥ng bao g·ªìm trong v√© v√†o c·ª≠a VinWonders</li>
                       <li>- Thu·ª∑ cung t·∫°m th·ªùi ƒë√≥ng c·ª≠a ƒë·ªÉ n√¢ng c·∫•p t·ª´ ng√†y 31/3/2025 ƒë·∫øn th√°ng 2/2026</li>
                       <li>- ƒê·ªÉ ƒë·∫£m b·∫£o an to√†n, ng∆∞·ªùi tham gia c√°c tr√≤ ch∆°i tr∆∞·ª£t n∆∞·ªõc m·∫°o hi·ªÉm t·∫°i C√¥ng Vi√™n N∆∞·ªõc y√™u c·∫ßu ph·∫£i c√≥ chi·ªÅu cao tr√™n 130cm, c√¢n n·∫∑ng d∆∞·ªõi 100kg v√† d∆∞·ªõi 50 tu·ªïi</li>
                     </ul>
                   `;

        modalDescription.innerHTML = details;
        modal.style.display = "flex";
        attachSliderListeners();
      }

      // Function for "V√© V√†o C·ª≠a Ti√™u Chu·∫©n"
      function showTicketStandardDetail() {
        const title =
          "[VinWonders Nha Trang] - V√© V√†o C·ª≠a Ti√™u Chu·∫©n | T·∫∑ng Voucher ·∫©m th·ª±c";
        currentImages = ticketImages["Ti√™u Chu·∫©n"];
        currentImageIndex = 0;

        modalTitle.textContent = title;

        let details = createImageSlider(currentImages, title);

        details += `
                     <h4>BAO G·ªíM</h4>
                     <ul>
                       <li>- V√© v√†o c·ª≠a tr·ª±c ti·∫øp VinWonders Nha Trang</li>
                       <li>- Di chuy·ªÉn b·∫±ng c√°p treo 2 chi·ªÅu</li>
                       <li>- T·∫∂NG: Voucher ·∫©m th·ª±c tr·ªã gi√° 150k/Ng∆∞·ªùi l·ªõn; 100k/Tr·∫ª em, Ng∆∞·ªùi cao tu·ªïi (√°p d·ª•ng t·ª´ 15/08 - 30/11, lo·∫°i tr·ª´ 30/08 - 02/09)</li>
                       <li>- √Åp d·ª•ng t·∫°i c√°c nh√† h√†ng: Wind & Sea (11.1), Coral (11.2), Yummy WaterWorld (76), Yummy World Garden (35), Kiosk Monta (25), Wonder Ice cream & Bakery (15), Streetfood</li>
                       <li>- Mi·ªÖn ph√≠ 02 l∆∞·ª£t s·ª≠ d·ª•ng VinBus trong ng√†y</li>
                     </ul>
                     <h4>ƒêI·ªÄU KHO·∫¢N</h4>
                     <ul>
                       <li>- Trong tr∆∞·ªùng h·ª£p th·ªùi ti·∫øt kh√¥ng thu·∫≠n l·ª£i, c√°p treo bu·ªôc ph·∫£i d·ª´ng ho·∫°t ƒë·ªông ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n, VinWonders s·∫Ω s·∫Øp x·∫øp ph∆∞∆°ng ti·ªán di chuy·ªÉn thay th·∫ø b·∫±ng t√†u cao t·ªëc</li>
                       <li>- Zipline kh√¥ng bao g·ªìm trong v√© v√†o c·ª≠a VinWonders</li>
                       <li>- Thu·ª∑ cung t·∫°m th·ªùi ƒë√≥ng c·ª≠a ƒë·ªÉ n√¢ng c·∫•p t·ª´ ng√†y 31/3/2025 ƒë·∫øn th√°ng 2/2026</li>
                       <li>- ƒê·ªÉ ƒë·∫£m b·∫£o an to√†n, ng∆∞·ªùi tham gia c√°c tr√≤ ch∆°i tr∆∞·ª£t n∆∞·ªõc m·∫°o hi·ªÉm t·∫°i C√¥ng Vi√™n N∆∞·ªõc y√™u c·∫ßu ph·∫£i c√≥ chi·ªÅu cao tr√™n 130cm, c√¢n n·∫∑ng d∆∞·ªõi 100kg v√† d∆∞·ªõi 50 tu·ªïi</li>
                     </ul>
                   `;

        modalDescription.innerHTML = details;
        modal.style.display = "flex";
        attachSliderListeners();
      }

      // Function for "Combo V√© V√†o C·ª≠a VinWonders"
      function showTicketComboDetail() {
        const title =
          "[VinWonders Nha Trang] - Combo V√© V√†o C·ª≠a VinWonders + D·ªãch v·ª• Buffet";
        currentImages = ticketImages["Combo"];
        currentImageIndex = 0;

        modalTitle.textContent = title;

        let details = createImageSlider(currentImages, title);

        details += `
                     <h4>BAO G·ªíM</h4>
                     <ul>
                       <li>- V√© v√†o c·ª≠a VinWonders Nha Trang</li>
                       <li>- Di chuy·ªÉn b·∫±ng c√°p treo 2 chi·ªÅu</li>
                       <li>- S·ª≠ d·ª•ng d·ªãch v·ª• Buffet tr·ªã gi√° 300.000 VNƒê/Ng∆∞·ªùi l·ªõn ho·∫∑c Ng∆∞·ªùi cao tu·ªïi; 150.000 VNƒê/Tr·∫ª em t·∫°i nh√† h√†ng Wind & Sea s·ªë 11.1 (khung gi·ªù √°p d·ª•ng 11:00 - 14:30)</li>
                       <li>- Mi·ªÖn ph√≠ 02 l∆∞·ª£t s·ª≠ d·ª•ng d·ªãch v·ª• xe bu√Ωt VinBus trong ng√†y</li>
                     </ul>
                     <h4>ƒêI·ªÄU KHO·∫¢N</h4>
                     <ul>
                       <li>- Trong tr∆∞·ªùng h·ª£p ƒëi·ªÅu ki·ªán th·ªùi ti·∫øt kh√¥ng thu·∫≠n l·ª£i, c√°p treo bu·ªôc ph·∫£i d·ª´ng ho·∫°t ƒë·ªông ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n, VinWonders s·∫Ω s·∫Øp x·∫øp ph∆∞∆°ng ti·ªán di chuy·ªÉn thay th·∫ø b·∫±ng t√†u cao t·ªëc</li>
                       <li>- Zipline kh√¥ng bao g·ªìm trong v√© v√†o c·ª≠a VinWonders</li>
                       <li>- Thu·ª∑ cung t·∫°m th·ªùi ƒë√≥ng c·ª≠a ƒë·ªÉ n√¢ng c·∫•p t·ª´ ng√†y 31/3/2025 ƒë·∫øn th√°ng 2/2026</li>
                       <li>- ƒê·ªÉ ƒë·∫£m b·∫£o an to√†n, ng∆∞·ªùi tham gia c√°c tr√≤ ch∆°i tr∆∞·ª£t n∆∞·ªõc m·∫°o hi·ªÉm t·∫°i C√¥ng Vi√™n N∆∞·ªõc y√™u c·∫ßu ph·∫£i c√≥ chi·ªÅu cao tr√™n 130cm, c√¢n n·∫∑ng d∆∞·ªõi 100kg v√† d∆∞·ªõi 50 tu·ªïi</li>
                     </ul>
                   `;

        modalDescription.innerHTML = details;
        modal.style.display = "flex";
        attachSliderListeners();
      }

      // L·∫Øng nghe click v√†o c√°c n√∫t "Xem chi ti·∫øt"
      document.querySelectorAll(".ticket-card a").forEach((link, index) => {
        link.addEventListener("click", (e) => {
          e.preventDefault();

          // Call the appropriate function based on the ticket index
          if (index === 0) {
            showTicketComboDetail();
          } else if (index === 1) {
            showTicketStandardDetail();
          } else if (index === 2) {
            showTicketAfter16hDetail();
          }
        });
      });

      // ƒê√≥ng modal khi b·∫•m n√∫t X
      closeBtn.addEventListener("click", () => (modal.style.display = "none"));

      // ƒê√≥ng khi click ra ngo√†i
      window.addEventListener("click", (e) => {
        if (e.target === modal) modal.style.display = "none";
      });

      // Function to change image in modal
      window.changeImage = function (direction) {
        currentImageIndex += direction;

        if (currentImageIndex < 0) {
          currentImageIndex = currentImages.length - 1;
        } else if (currentImageIndex >= currentImages.length) {
          currentImageIndex = 0;
        }

        document.getElementById("modalImage").src =
          currentImages[currentImageIndex];
        document.getElementById("currentImageNum").textContent =
          currentImageIndex + 1;
      };

      const buyModal = document.getElementById("buyModal");
      const buyCloseBtn = buyModal.querySelector(".close-btn");
      const totalElement = buyModal.querySelector(".total");
      let selectedChooseBtn = null;
      let selectedTicketData = null;
      // Hardcoded ticket data for each ticket type
      function getComboTicketData() {
        return {
          title:
            "[VinWonders Nha Trang] - Combo V√© V√†o C·ª≠a VinWonders + D·ªãch v·ª• Buffet",
          tickets: [
            {
              type: "Ng∆∞·ªùi l·ªõn",
              description: "Cao t·ª´ 140cm",
              price_original: 1190000,
              price_discount: 1100000,
            },
            {
              type: "Tr·∫ª em",
              description: "Cao t·ª´ 100-139cm",
              price_original: 820000,
              price_discount: 760000,
            },
            {
              type: "Ng∆∞·ªùi cao tu·ªïi",
              description: "T·ª´ 60 tu·ªïi",
              price_original: 960000,
              price_discount: 910000,
            },
          ],
        };
      }

      function getStandardTicketData() {
        return {
          title:
            "[VinWonders Nha Trang] - V√© V√†o C·ª≠a Ti√™u Chu·∫©n | T·∫∑ng Voucher ·∫©m th·ª±c",
          tickets: [
            {
              type: "Ng∆∞·ªùi l·ªõn",
              description: "Cao t·ª´ 140cm",
              price_original: null,
              price_discount: 950000,
            },
            {
              type: "Tr·∫ª em",
              description: "Cao t·ª´ 100-139cm",
              price_original: null,
              price_discount: 710000,
            },
            {
              type: "Ng∆∞·ªùi cao tu·ªïi",
              description: "T·ª´ 60 tu·ªïi",
              price_original: null,
              price_discount: 710000,
            },
          ],
        };
      }

      function getAfter16hTicketData() {
        return {
          title: "[VinWonders Nha Trang] - V√© v√†o c·ª≠a VinWonders sau 16h00",
          tickets: [
            {
              type: "Ng∆∞·ªùi l·ªõn",
              description: "Cao t·ª´ 140cm",
              price_original: null,
              price_discount: 660000,
            },
            {
              type: "Tr·∫ª em",
              description: "Cao t·ª´ 100-139cm",
              price_original: null,
              price_discount: 500000,
            },
            {
              type: "Ng∆∞·ªùi cao tu·ªïi",
              description: "T·ª´ 60 tu·ªïi",
              price_original: null,
              price_discount: 500000,
            },
          ],
        };
      }

      function updateBuyModalWithTicketData(ticketData) {
        const ticketTypes = buyModal.querySelectorAll(".ticket-type");

        ticketTypes.forEach((typeEl, index) => {
          if (ticketData.tickets[index]) {
            const ticket = ticketData.tickets[index];
            const priceEl = typeEl.querySelector(".price");
            const countEl = typeEl.querySelector(".count");

            priceEl.textContent =
              ticket.price_discount.toLocaleString("vi-VN") + " ƒë";
            countEl.textContent = "0";
          }
        });

        updateTotal();
      }

      document.querySelectorAll(".btn-choose").forEach((btn) => {
        btn.addEventListener("click", (e) => {
          selectedChooseBtn = e.target;

          // Determine which ticket was clicked
          const ticketCard = e.target.closest(".ticket-card");
          const ticketIndex = Array.from(
            document.querySelectorAll(".ticket-card"),
          ).indexOf(ticketCard);

          if (ticketIndex === 0) {
            selectedTicketData = getComboTicketData();
          } else if (ticketIndex === 1) {
            selectedTicketData = getStandardTicketData();
          } else if (ticketIndex === 2) {
            selectedTicketData = getAfter16hTicketData();
          }

          updateBuyModalWithTicketData(selectedTicketData);
          buyModal.style.display = "flex";
        });
      });

      buyCloseBtn.addEventListener("click", () => {
        buyModal.style.display = "none";
      });

      window.addEventListener("click", (e) => {
        if (e.target === buyModal) buyModal.style.display = "none";
      });

      // --- C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng v√† t·ªïng ti·ªÅn ---
      buyModal.querySelectorAll(".ticket-type").forEach((type) => {
        const plus = type.querySelector(".plus");
        const minus = type.querySelector(".minus");
        const countEl = type.querySelector(".count");
        const price = 100000;

        plus.addEventListener("click", () => {
          countEl.textContent = parseInt(countEl.textContent) + 1;
          updateTotal();
        });

        minus.addEventListener("click", () => {
          const current = parseInt(countEl.textContent);
          if (current > 0) countEl.textContent = current - 1;
          updateTotal();
        });
      });

      function updateTotal() {
        let total = 0;
        buyModal.querySelectorAll(".ticket-type").forEach((type, index) => {
          const count = parseInt(type.querySelector(".count").textContent);
          if (selectedTicketData && selectedTicketData.tickets[index]) {
            const price = selectedTicketData.tickets[index].price_discount;
            total += count * price;
          }
        });
        totalElement.textContent = total.toLocaleString("vi-VN") + " ƒë";

        // V√¥ hi·ªáu h√≥a n√∫t mua n·∫øu t·ªïng ti·ªÅn = 0
        const buyBtn = buyModal.querySelector(".buy-btn");
        if (total === 0) {
          buyBtn.disabled = true;
          buyBtn.style.opacity = "0.6";
          buyBtn.style.cursor = "not-allowed";
        } else {
          buyBtn.disabled = false;
          buyBtn.style.opacity = "1";
          buyBtn.style.cursor = "pointer";
        }
      }

      const timeButtons = document.querySelectorAll(".time-btn");

      timeButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          // X√≥a class active ·ªü t·∫•t c·∫£ n√∫t
          timeButtons.forEach((b) => b.classList.remove("active"));
          // Th√™m class active cho n√∫t ƒë∆∞·ª£c ch·ªçn
          btn.classList.add("active");
        });
      });

      const buyBtn = buyModal.querySelector(".buy-btn");
      buyBtn.addEventListener("click", () => {
        const selectedTime =
          buyModal.querySelector(".time-btn.active").textContent;
        const selectedBranch = buyModal.querySelector(
          ".location-options .active",
        ).textContent;

        const total = parseInt(totalElement.textContent.replace(/\D/g, ""));

        // üü¢ L·∫•y s·ªë l∆∞·ª£ng t·ª´ng lo·∫°i v√©
        const ticketTypes = buyModal.querySelectorAll(".ticket-type");
        const persons = [];
        ticketTypes.forEach((type) => {
          const name = type.querySelector("p").textContent.trim();
          const count = parseInt(type.querySelector(".count").textContent);
          if (count > 0) persons.push(`${count} ${name}`);
        });

        // üü¢ L·∫•y d·ªØ li·ªáu t·ª´ ticket ƒë∆∞·ª£c ch·ªçn
        const locationName =
          document.querySelector(".info h2")?.textContent.trim() ||
          "Kh√¥ng r√µ ƒë·ªãa ƒëi·ªÉm";

        const selectedTicket = ticketInfo[selectedTicketIndex];
        const title = selectedTicket ? selectedTicket.title : "Kh√¥ng r√µ v√©";

        const imageSrc =
          document.querySelector(".banner img")?.src || "./assets/default.jpg";

        // üü¢ L·∫•y ng√†y hi·ªÉn th·ªã ·ªü n√∫t ng√†y
        const selectedDate =
          document.querySelector(".date-buttons .active")?.textContent.trim() ||
          "Kh√¥ng r√µ ng√†y";

        const cartItem = {
          location: locationName,
          title: title,
          branch: selectedBranch,
          time: selectedTime,
          date: selectedDate,
          person: persons.join(", "),
          price: total,
          image: imageSrc,
        };

        const cart = JSON.parse(localStorage.getItem("cart")) || [];
        cart.push(cartItem);
        localStorage.setItem("cart", JSON.stringify(cart));

        buyModal.style.display = "none";
        window.location.href = "./cart.html";
      });

      function resetBuyModal() {
        buyModal.querySelectorAll(".ticket-type").forEach((type) => {
          const countEl = type.querySelector(".count");
          countEl.textContent = "0";
        });
        updateTotal();
      }

      // ƒê√≥ng modal x√°c nh·∫≠n
      const confirmCloseBtn = document.querySelector(
        "#confirmModal .close-btn",
      );
      const confirmModal = document.getElementById("confirmModal");

      if (confirmCloseBtn) {
        confirmCloseBtn.addEventListener("click", () => {
          confirmModal.style.display = "none";
        });
      }

      if (confirmModal) {
        window.addEventListener("click", (e) => {
          if (e.target === confirmModal) confirmModal.style.display = "none";
        });
      }
    </script>
  </body>
</html>
