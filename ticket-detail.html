<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VinWonders</title>
    <link rel="icon" type="image/png" href="./assets/iconlogo.png" />
    <link rel="stylesheet" href="./style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
      integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer" />
  </head>
  <body>
    <div class="wrapperDetaiTicket">
      <div class="ticket-detail">
        <div class="banner">
          <img
            src="./assets/vinwonders-nha-trang.jpg"
            alt="VinWonders Nha Trang" />
          <div class="back-btn">
            <a href="./ticket.html"><i class="fa-solid fa-arrow-left"></i></a>
          </div>
          <div class="cart-btn"><i class="fa-regular fa-heart"></i></div>
        </div>
        <div class="info">
          <h2>VinWonders Nha Trang</h2>
          <p class="rating"><span>‚≠ê 4.2</span> (7529 l∆∞·ª£t ƒë√°nh gi√°)</p>

          <div class="date-buttons">
            <button>H√¥m nay</button>
            <button>Ng√†y mai</button>
            <button class="active">
              <i class="fa-regular fa-calendar"></i> 27/10/2025
            </button>
          </div>

          <div class="filter-buttons">
            <button class="active">T·∫•t c·∫£ v√©</button>
            <button><i class="fa-solid fa-fire"></i> B√°n ch·∫°y nh·∫•t</button>
            <button>G√≥i VIP</button>
          </div>
        </div>

        <div class="ticket-card-list">
          <div class="ticket-card">
            <h3>
              [Nha Trang Passport] - [N·ª≠a ng√†y] - C√°p treo + X√¥ng h∆°i Aquafield
              (2 ti·∫øng) + Tata Show
            </h3>
            <ul>
              <li>B√© h√≥a th√¢n th√†nh nh√¢n vi√™n s·ªü th√∫ nh√≠</li>
              <li>Tr·∫£i nghi·ªám chƒÉm s√≥c, t∆∞∆°ng t√°c v·ªõi ƒë·ªông v·∫≠t</li>
              <li>L·ªõp h·ªçc di·ªÖn ra trong 01 ti·∫øng</li>
            </ul>
            <a href="#">Xem chi ti·∫øt ¬ª</a>

            <div class="price-box">
              <p>Ch·ªâ t·ª´ <span class="price">300,000 ƒë</span></p>
              <button class="btn-choose">Ch·ªçn</button>
            </div>
          </div>
          <div class="ticket-card">
            <h3>
              [VinWonders Nha Trang ] - V√© v√†o c·ª≠a Ti√™u chu·∫©n - T·∫∑ng voucher ·∫©m
              th·ª±c
            </h3>
            <ul>
              <li>V√© v√†o c·ª≠a khu vui ch∆°i 1 l·∫ßn trong ng√†y</li>
              <li>Di chuy·ªÉn b·∫±ng cap treo 02 chi·ªÅu + 02 l∆∞·ª£t VinBus mi·ªÖn ph√≠</li>
              <li>T·∫∑ng voucher ·∫©m th·ª±c t·ª´ 15/08 - 30/11</li>
            </ul>
            <a href="#">Xem chi ti·∫øt ¬ª</a>

            <div class="price-box">
              <p>Ch·ªâ t·ª´ <span class="price">950,000 ƒë</span></p>
              <button class="btn-choose">Ch·ªçn</button>
            </div>
          </div>
        </div>
      </div>

      <!-- modal chi ti·∫øt v√© -->
      <div id="ticketModal" class="modal">
        <div class="modal-content">
          <span class="close-btn">&times;</span>
          <h3 class="modal-title">Chi ti·∫øt v√©</h3>
          <p class="modal-description">
            ƒê√¢y l√† m√¥ t·∫£ chi ti·∫øt c·ªßa g√≥i v√© b·∫°n ch·ªçn.
          </p>
        </div>
      </div>
      <!-- modal mua v√© -->
      <div id="buyModal" class="modalBuyTicket">
        <div class="modal-content ticket-buy">
          <span class="close-btn">&times;</span>
          <h3 class="modal-title">Ch·ªçn lo·∫°i v√©</h3>
          <p>[Vinpearl Harbour] - V√© xem Tata Show</p>

          <!-- Ch·ªçn c∆° s·ªü -->
          <div class="location-section">
            <h4><i class="fa-solid fa-location-dot"></i> Ch·ªçn c∆° s·ªü</h4>
            <div class="location-options">
              <button class="active">ZooKeeper NT</button>
            </div>
          </div>

          <!-- Ch·ªçn th·ªùi gian -->
          <div class="time-section">
            <h4><i class="fa-regular fa-clock"></i> Ch·ªçn th·ªùi gian</h4>
            <div class="time-options">
              <button class="time-btn active">9:30</button>
              <button class="time-btn">14:00</button>
            </div>
          </div>

          <div class="quantity-section">
            <h4><i class="fa-solid fa-user-group"></i> S·ªë l∆∞·ª£ng mua</h4>

            <div class="ticket-type">
              <div>
                <p>Ng∆∞·ªùi l·ªõn</p>
                <small>Cao t·ª´ 140cm</small>
              </div>
              <div class="price">100,000 ƒë</div>
              <div class="counter">
                <button class="minus">‚àí</button>
                <span class="count">1</span>
                <button class="plus">+</button>
              </div>
            </div>

            <div class="ticket-type">
              <div>
                <p>Tr·∫ª em</p>
                <small
                  >Cao t·ª´ <br />
                  100cm‚Äì139cm</small
                >
              </div>
              <div class="price">100,000 ƒë</div>
              <div class="counter">
                <button class="minus">‚àí</button>
                <span class="count">0</span>
                <button class="plus">+</button>
              </div>
            </div>

            <div class="ticket-type">
              <div>
                <p>Ng∆∞·ªùi cao tu·ªïi</p>
                <small>T·ª´ 60 tu·ªïi</small>
              </div>
              <div class="price">100,000 ƒë</div>
              <div class="counter">
                <button class="minus">‚àí</button>
                <span class="count">0</span>
                <button class="plus">+</button>
              </div>
            </div>
          </div>

          <div class="footer">
            <span class="total">100,000 ƒë</span>
            <button class="buy-btn">Mua ngay</button>
          </div>
        </div>
      </div>
    </div>
    <script>
      const params = new URLSearchParams(window.location.search);
      const selectedLocation = params.get("location");
      const selectedDate = params.get("date");

      // --- C·∫≠p nh·∫≠t v√†o giao di·ªán ---
      // G·∫Øn t√™n ƒëi·ªÉm ƒë·∫øn v√†o th·∫ª h2
      const titleElement = document.querySelector(".info h2");
      if (selectedLocation) {
        titleElement.textContent = selectedLocation;
      } else {
        titleElement.textContent = "Kh√¥ng c√≥ d·ªØ li·ªáu";
      }

      // G·∫Øn ng√†y v√†o n√∫t l·ªãch
      const dateButton = document.querySelector(".date-buttons button.active");
      if (selectedDate) {
        dateButton.innerHTML = `<i class="fa-regular fa-calendar"></i> ${selectedDate}`;
      } else {
        dateButton.innerHTML = `<i class="fa-regular fa-calendar"></i> Kh√¥ng c√≥ d·ªØ li·ªáu`;
      }

      const modal = document.getElementById("ticketModal");
      const modalTitle = document.querySelector(".modal-title");
      const modalDescription = document.querySelector(".modal-description");
      const closeBtn = document.querySelector(".close-btn");

      // L·∫Øng nghe click v√†o c√°c n√∫t "Xem chi ti·∫øt"
      document.querySelectorAll(".ticket-card a").forEach((link) => {
        link.addEventListener("click", (e) => {
          e.preventDefault();

          // Tu·ª≥ ch·ªânh n·ªôi dung modal theo th·∫ª v√© ƒë∆∞·ª£c b·∫•m
          const card = e.target.closest(".ticket-card");
          const title =
            card.querySelector("h3")?.textContent.trim() || "Chi ti·∫øt v√©";
          // const details =
          //   card.querySelector("ul")?.innerHTML ||
          //   "<p>Kh√¥ng c√≥ th√¥ng tin chi ti·∫øt</p>";

          const details = `
      <h4>BAO G·ªíM</h4>
      <ul>
        <li>- Di chuy·ªÉn b·∫±ng c√°p treo 02 chi·ªÅu</li>
        <li>- X√¥ng h∆°i 02 ti·∫øng t·∫°i Aquafield</li>
        <li>- V√© xem Tata Show (v√†o c·ª≠a VinWonders Nha Trang t·ª´ 18:30)</li>
        <li>- Mi·ªÖn ph√≠ 02 l∆∞·ª£t s·ª≠ d·ª•ng d·ªãch v·ª• xe bu√Ωt VinBus trong ng√†y</li>
      </ul>
      <h4>M√¥ T·∫¢</h4>
      <ul>
        <li>- Tr·∫£i nghi·ªám c√°p treo v∆∞·ª£t bi·ªÉn ƒë·∫ßu ti√™n t·∫°i Vi·ªát Nam
ng·∫Øm tr·ªçn v·∫ª ƒë·∫πp c·ªßa v·ªãnh bi·ªÉn Nha Trang</li>
        <li>- Th∆∞ gi√£n, th·∫£i ƒë·ªôc c∆° th·ªÉ v·ªõi li·ªáu tr√¨nh x√¥ng h∆°i 7 ph√≤ng
tr·ªã li·ªáu t·∫°i Aquafield ‚Äì T·ªï h·ª£p spa & x√¥ng h∆°i cao c·∫•p Top
1 H√†n Qu·ªëc ƒë·∫ßu ti√™n t·∫°i Vi·ªát Nam trong 02 ti·∫øng.</li>
      </ul>
      <h4>ƒêI·ªÄU KHO·∫¢N</h4>
      <ul>
        <li>- Trong tr∆∞·ªùng h·ª£p ƒëi·ªÅu ki·ªán th·ªùi ti·∫øt kh√¥ng thu·∫≠n l·ª£i, c√°p
treo bu·ªôc ph·∫£i d·ª´ng ho·∫°t ƒë·ªông ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n,
VinWonders s·∫Ω s·∫Øp x·∫øp ph∆∞∆°ng ti·ªán di chuy·ªÉn thay th·∫ø</li>
       
      </ul>
    `;

          modalTitle.textContent = title;
          modalDescription.innerHTML = details;

          modal.style.display = "flex";
        });
      });

      // ƒê√≥ng modal khi b·∫•m n√∫t X
      closeBtn.addEventListener("click", () => (modal.style.display = "none"));

      // ƒê√≥ng khi click ra ngo√†i
      window.addEventListener("click", (e) => {
        if (e.target === modal) modal.style.display = "none";
      });

      const buyModal = document.getElementById("buyModal");
      const buyCloseBtn = buyModal.querySelector(".close-btn");
      const totalElement = buyModal.querySelector(".total");
      let selectedChooseBtn = null;

      document.querySelectorAll(".btn-choose").forEach((btn) => {
        btn.addEventListener("click", (e) => {
          selectedChooseBtn = e.target;
          buyModal.style.display = "flex";
        });
      });

      buyCloseBtn.addEventListener("click", () => {
        buyModal.style.display = "none";
      });

      window.addEventListener("click", (e) => {
        if (e.target === buyModal) buyModal.style.display = "none";
      });

      // --- C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng v√† t·ªïng ti·ªÅn ---
      buyModal.querySelectorAll(".ticket-type").forEach((type) => {
        const plus = type.querySelector(".plus");
        const minus = type.querySelector(".minus");
        const countEl = type.querySelector(".count");
        const price = 100000;

        plus.addEventListener("click", () => {
          countEl.textContent = parseInt(countEl.textContent) + 1;
          updateTotal();
        });

        minus.addEventListener("click", () => {
          const current = parseInt(countEl.textContent);
          if (current > 0) countEl.textContent = current - 1;
          updateTotal();
        });
      });

      function updateTotal() {
        let total = 0;
        buyModal.querySelectorAll(".ticket-type").forEach((type) => {
          const count = parseInt(type.querySelector(".count").textContent);
          total += count * 100000;
        });
        totalElement.textContent = total.toLocaleString("vi-VN") + " ƒë";

        // V√¥ hi·ªáu h√≥a n√∫t mua n·∫øu t·ªïng ti·ªÅn = 0
        const buyBtn = buyModal.querySelector(".buy-btn");
        if (total === 0) {
          buyBtn.disabled = true;
          buyBtn.style.opacity = "0.6";
          buyBtn.style.cursor = "not-allowed";
        } else {
          buyBtn.disabled = false;
          buyBtn.style.opacity = "1";
          buyBtn.style.cursor = "pointer";
        }
      }

      const timeButtons = document.querySelectorAll(".time-btn");

      timeButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          // X√≥a class active ·ªü t·∫•t c·∫£ n√∫t
          timeButtons.forEach((b) => b.classList.remove("active"));
          // Th√™m class active cho n√∫t ƒë∆∞·ª£c ch·ªçn
          btn.classList.add("active");
        });
      });

      const buyBtn = buyModal.querySelector(".buy-btn");
      buyBtn.addEventListener("click", () => {
        const selectedTime =
          buyModal.querySelector(".time-btn.active").textContent;
        const selectedBranch = buyModal.querySelector(
          ".location-options .active"
        ).textContent;

        const total = parseInt(totalElement.textContent.replace(/\D/g, ""));

        // üü¢ L·∫•y s·ªë l∆∞·ª£ng t·ª´ng lo·∫°i v√©
        const ticketTypes = buyModal.querySelectorAll(".ticket-type");
        const persons = [];
        ticketTypes.forEach((type) => {
          const name = type.querySelector("p").textContent.trim();
          const count = parseInt(type.querySelector(".count").textContent);
          if (count > 0) persons.push(`${count} ${name}`);
        });

        // üü¢ L·∫•y d·ªØ li·ªáu ƒë·ªông t·ª´ trang hi·ªán t·∫°i
        const locationName =
          document.querySelector(".info h2")?.textContent.trim() ||
          "Kh√¥ng r√µ ƒë·ªãa ƒëi·ªÉm";
        const title =
          document.querySelector(".ticket-card h3")?.textContent.trim() ||
          "Kh√¥ng r√µ v√©";
        const imageSrc =
          document.querySelector(".banner img")?.src || "./assets/default.jpg";

        // üü¢ L·∫•y ng√†y hi·ªÉn th·ªã ·ªü n√∫t ng√†y
        const selectedDate =
          document.querySelector(".date-buttons .active")?.textContent.trim() ||
          "Kh√¥ng r√µ ng√†y";

        const cartItem = {
          location: locationName,
          title: title,
          branch: selectedBranch,
          time: selectedTime,
          date: selectedDate,
          person: persons.join(", "),
          price: total,
          image: imageSrc,
        };

        const cart = JSON.parse(localStorage.getItem("cart")) || [];
        cart.push(cartItem);
        localStorage.setItem("cart", JSON.stringify(cart));

        buyModal.style.display = "none";
        window.location.href = "./cart.html";
      });

      function resetBuyModal() {
        buyModal.querySelectorAll(".ticket-type").forEach((type) => {
          const countEl = type.querySelector(".count");
          countEl.textContent = "0"; // reset t·∫•t c·∫£ v·ªÅ 0
        });
        updateTotal();
      }

      // ƒê√≥ng modal x√°c nh·∫≠n
      confirmCloseBtn.addEventListener("click", () => {
        confirmModal.style.display = "none";
      });

      window.addEventListener("click", (e) => {
        if (e.target === confirmModal) confirmModal.style.display = "none";
      });
    </script>
  </body>
</html>
